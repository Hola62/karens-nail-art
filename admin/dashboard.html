<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin Dashboard - Karen's Nail Art</title>
    <link rel="stylesheet" href="../css/style.css">
    <link rel="stylesheet" href="css/admin-style.css">
</head>

<body class="admin-body">

    <!-- Admin Sidebar -->
    <div class="admin-sidebar">
        <div class="admin-logo">
            <h2>Karen's Nail Art</h2>
            <p>Admin Panel</p>
        </div>

        <div class="admin-profile">
            <div class="profile-pic-container">
                <img src="uploads/karen-profile.jpg" alt="Karen" id="adminProfilePic">
                <button class="edit-profile-pic" onclick="changeProfilePic()">Edit</button>
            </div>
            <h3 id="adminName">Karen</h3>
            <p id="adminRole">Super Admin</p>
        </div>

        <nav class="admin-nav">
            <a href="#dashboard" class="nav-item active" onclick="showSection('dashboard')">
                Dashboard
            </a>
            <a href="#gallery" class="nav-item" onclick="showSection('gallery')">
                Gallery
            </a>
            <a href="#images" class="nav-item" onclick="showSection('images')">
                Upload Images
            </a>
            <a href="#services" class="nav-item" onclick="showSection('services')">
                Manage Services
            </a>
            <a href="#inquiries" class="nav-item" onclick="showSection('inquiries')">
                Customer Inquiries
            </a>
            <a href="#testimonials" class="nav-item" onclick="showSection('testimonials')">
                Testimonials
            </a>
            <a href="#products" class="nav-item" onclick="showSection('products')">
                Products
            </a>
            <a href="#team" class="nav-item" onclick="showSection('team')">
                Team Management
            </a>
            <a href="#settings" class="nav-item" onclick="showSection('settings')">
                Settings
            </a>
            <a href="#" class="nav-item logout" onclick="logout()">
                Logout
            </a>
        </nav>
    </div>

    <!-- Main Content Area -->
    <div class="admin-content">
        <div class="admin-header">
            <h1>Welcome Back, <span id="welcomeName">Karen</span>!</h1>
            <div class="header-actions">
                <button class="btn-primary" onclick="window.open('../index.html', '_blank')">View Website</button>
            </div>
        </div>

        <!-- Dashboard Section -->
        <section id="section-dashboard" class="admin-section active">
            <h2>Dashboard Overview</h2>

            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-info">
                        <h3>Total Visits</h3>
                        <p class="stat-number">0</p>
                    </div>
                </div>
                <div class="stat-card">
                    <div class="stat-info">
                        <h3>Total Likes</h3>
                        <p class="stat-number">0</p>
                    </div>
                </div>
                <div class="stat-card">
                    <div class="stat-info">
                        <h3>Total Shares</h3>
                        <p class="stat-number">0</p>
                    </div>
                </div>
                <div class="stat-card">
                    <div class="stat-info">
                        <h3>New Inquiries</h3>
                        <p class="stat-number">0</p>
                    </div>
                </div>
            </div>

            <div class="dashboard-grid">
                <div class="dashboard-card">
                    <h3>Recent Activity</h3>
                    <ul class="activity-list" id="recentActivityList">
                        <li>No recent activity yet</li>
                    </ul>
                </div>

                <div class="dashboard-card">
                    <h3>Quick Actions</h3>
                    <div class="quick-actions">
                        <button class="action-btn" onclick="showSection('images')">Upload Image</button>
                        <button class="action-btn" onclick="showSection('services')">Edit Service</button>
                        <button class="action-btn" onclick="showSection('team')">Add Team Member</button>
                        <button class="action-btn" onclick="showSection('settings')">Update Info</button>
                    </div>
                </div>
            </div>
        </section>

        <!-- Gallery Section - View All Uploaded Images -->
        <section id="section-gallery" class="admin-section">
            <h2>Gallery - All Uploaded Images</h2>
            <p class="subtitle">View and manage all images uploaded by you and your team</p>

            <div class="gallery-filters">
                <label for="galleryFilter" class="sr-only">Filter gallery images</label>
                <select id="galleryFilter" onchange="filterGalleryImages(this.value)"
                    aria-label="Filter gallery images">
                    <option value="all">All Images</option>
                    <option value="my-uploads">My Uploads Only</option>
                    <option value="gel-polish">Gel Polish</option>
                    <option value="acrylic-nails">Acrylic Nails</option>
                    <option value="nail-art">Nail Art</option>
                    <option value="home">Home Gallery</option>
                </select>
            </div>

            <div class="gallery-stats">
                <div class="stat-badge">
                    <span id="totalImagesCount">0</span> Total Images
                </div>
                <div class="stat-badge">
                    <span id="myImagesCount">0</span> My Uploads
                </div>
            </div>

            <div class="gallery-grid" id="adminGalleryGrid">
                <p class="empty-state">No images uploaded yet. Go to "Upload Images" to add some!</p>
            </div>
        </section>

        <!-- Images Section -->
        <section id="section-images" class="admin-section">
            <h2>Manage Images</h2>

            <div class="upload-section">
                <h3>Upload New Images</h3>
                <div class="upload-box">
                    <input type="file" id="imageUpload" accept="image/*" multiple>
                    <label for="imageUpload" class="upload-label">
                        <p>Click to upload or drag and drop</p>
                        <small>Supports: JPG, PNG (Max 5MB)</small>
                    </label>
                </div>
                <div class="form-group">
                    <label for="displayLocation">Where should these images appear?</label>
                    <select id="displayLocation">
                        <option value="gallery-home">Gallery & Home Page (Default)</option>
                        <option value="gel-polish">Gel Polish Service Only</option>
                        <option value="acrylic-nails">Acrylic Nails Service Only</option>
                        <option value="nail-art">Nail Art Service Only</option>
                        <option value="pedicure">Pedicure Service Only</option>
                        <option value="manicure">Manicure Service Only</option>
                        <option value="nail-extensions">Nail Extensions Service Only</option>
                    </select>
                    <small class="form-hint">
                        üí° By default, images appear in Gallery & Home page. Select a service to add images to that
                        specific service page instead.
                    </small>
                </div>
                <button class="btn-primary" onclick="uploadImages()">Upload Images</button>
            </div>

            <div class="gallery-management">
                <h3>Current Images</h3>
                <div class="image-grid" id="imageGrid">
                    <!-- Images will be loaded here dynamically -->
                    <div class="image-item">
                        <img src="../assets/images/gel1.jpg" alt="Gel Polish">
                        <div class="image-actions">
                            <button class="btn-delete" onclick="deleteImage('gel1.jpg')">Delete</button>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Services Section -->
        <section id="section-services" class="admin-section">
            <h2>Manage Services</h2>

            <div class="services-list" id="servicesList">
                <!-- Services will be loaded dynamically -->
            </div>

            <button class="btn-primary add-new-service-btn" onclick="openAddServiceModal()">+ Add New Service</button>
        </section>

        <!-- Inquiries Section -->
        <section id="section-inquiries" class="admin-section">
            <h2>Customer Inquiries</h2>

            <div class="inquiries-list">
                <p class="empty-state">No inquiries yet. Customer messages will appear here.</p>
            </div>
        </section>

        <!-- Testimonials Section -->
        <section id="section-testimonials" class="admin-section">
            <h2>Manage Testimonials</h2>
            <p class="subtitle">Add and manage customer testimonials displayed on your website</p>

            <button class="btn-primary mb-20" onclick="openAddTestimonialModal()">+ Add New
                Testimonial</button>

            <div class="testimonials-list" id="testimonialsList">
                <!-- Testimonials will be loaded here -->
            </div>
        </section>

        <!-- Products Section -->
        <section id="section-products" class="admin-section">
            <h2>Manage Products</h2>
            <p class="subtitle">Add items you sell (name, price, description, image)</p>

            <div id="productsList">
                <!-- Products will be loaded dynamically -->
            </div>

            <button class="btn-primary add-new-service-btn" onclick="openAddProductModal()">+ Add New Product</button>
        </section>

        <!-- Team Management Section -->
        <section id="section-team" class="admin-section">
            <h2>Team Management</h2>

            <div class="team-list">
                <div class="team-member">
                    <div class="member-info">
                        <h3>Karen</h3>
                        <p>Super Admin</p>
                        <span class="member-status">Active</span>
                    </div>
                    <div class="member-actions">
                        <button class="btn-edit" disabled>You</button>
                    </div>
                </div>
            </div>

            <h3>Team Members List</h3>
            <div id="teamList" class="team-members-list">
                <p>Loading team members...</p>
            </div>

            <div class="add-team-form">
                <h3>Add New Team Member</h3>
                <div class="info-box">
                    <strong>Note:</strong> In localStorage mode, credentials are stored in the browser. For production
                    use, set up the backend for secure password hashing.
                </div>
                <div class="form-group">
                    <label for="teamName">Name:</label>
                    <input type="text" id="teamName" placeholder="Enter full name">
                </div>
                <div class="form-group">
                    <label for="teamUsername">Username:</label>
                    <input type="text" id="teamUsername" placeholder="Enter username (for login)">
                    <small class="form-hint">This will be used to login</small>
                </div>
                <div class="form-group">
                    <label for="teamEmail">Email:</label>
                    <input type="email" id="teamEmail" placeholder="Enter email">
                </div>
                <div class="form-group">
                    <label for="teamRole">Role:</label>
                    <select id="teamRole">
                        <option value="admin">Admin</option>
                        <option value="editor">Editor</option>
                    </select>
                </div>
                <div class="info-box password-info">
                    <strong>Default Password:</strong> All team members will use the same password as the super admin
                    (admin123). They can login with their username and this password.
                </div>
                <button class="btn-primary" onclick="addTeamMember()">Add Team Member</button>
            </div>
        </section>

        <!-- Settings Section -->
        <section id="section-settings" class="admin-section">
            <h2>Settings</h2>

            <div class="settings-form">
                <h3>Contact Information</h3>
                <div class="form-group">
                    <label for="settingsPhone">Phone Number:</label>
                    <input type="tel" id="settingsPhone" value="+234 XXX XXX XXXX">
                </div>
                <div class="form-group">
                    <label for="settingsEmail">Email:</label>
                    <input type="email" id="settingsEmail" value="info@karensnailart.com">
                </div>
                <div class="form-group">
                    <label for="settingsLocation">Location:</label>
                    <input type="text" id="settingsLocation" value="Abuja, Nigeria">
                </div>

                <h3>Social Media Links</h3>
                <div class="form-group">
                    <label for="settingsTikTok">TikTok Username:</label>
                    <input type="text" id="settingsTikTok" value="@eniola">
                </div>
                <div class="form-group">
                    <label for="settingsInstagram">Instagram Username:</label>
                    <input type="text" id="settingsInstagram" value="@karen_wealth">
                </div>
                <div class="form-group">
                    <label for="settingsWhatsApp">WhatsApp Number:</label>
                    <input type="tel" id="settingsWhatsApp" value="+234XXXXXXXXXX">
                </div>

                <h3>Change Password</h3>
                <div class="form-group">
                    <label for="currentPassword">Current Password:</label>
                    <input type="password" id="currentPassword">
                </div>
                <div class="form-group">
                    <label for="newPassword">New Password:</label>
                    <input type="password" id="newPassword">
                </div>
                <div class="form-group">
                    <label for="confirmPassword">Confirm Password:</label>
                    <input type="password" id="confirmPassword">
                </div>

                <button class="btn-primary" onclick="saveSettings()">Save All Changes</button>
            </div>
        </section>

    </div>

    <!-- EmailJS SDK for sending emails from the browser -->
    <script src="https://cdn.jsdelivr.net/npm/emailjs-com@3/dist/email.min.js"></script>

    <!-- Embedded email configuration (fallback if external file doesn't load) -->
    <script>
        // Email configuration - embedded for reliability
        if (typeof window.EMAIL_SETTINGS === 'undefined') {
            window.EMAIL_SETTINGS = {
                serviceId: 'service_1k6kdmg',
                templateId: 'template_d3ydngy',
                publicKey: 'GiDmg3fRq3ZWzWGAu',
                fromEmail: 'holuwahola3@gmail.com',
                fromName: "Karen's Nail Art"
            };
        }
    </script>

    <!-- Try to load external config (will be overridden by embedded if it loads later) -->
    <script type="module" src="../js/firebase-init.js"></script>
    <script src="../js/email-config.js"></script>
    <script src="../js/api-handler.js"></script>
    <script src="../js/analytics.js"></script>
    <script>
        // Initialize EmailJS if config is present
        document.addEventListener('DOMContentLoaded', function () {
            console.log('EmailJS Init Check:');
            console.log('- EMAIL_SETTINGS exists:', !!window.EMAIL_SETTINGS);
            console.log('- emailjs exists:', !!window.emailjs);

            if (window.EMAIL_SETTINGS) {
                console.log('- Service ID:', window.EMAIL_SETTINGS.serviceId);
                console.log('- Template ID:', window.EMAIL_SETTINGS.templateId);
                console.log('- Public Key:', window.EMAIL_SETTINGS.publicKey ? 'Set' : 'Missing');
            }

            if (window.EMAIL_SETTINGS && window.EMAIL_SETTINGS.publicKey && window.emailjs) {
                try {
                    emailjs.init(window.EMAIL_SETTINGS.publicKey);
                    console.log('‚úÖ EmailJS initialized successfully');
                } catch (e) {
                    console.error('‚ùå EmailJS init failed:', e);
                }
            } else {
                console.warn('‚ö†Ô∏è EmailJS not initialized - missing config or library');
            }
        });
    </script>
    <script src="script/admin.js"></script>

    <!-- Reply Modal -->
    <div id="replyModal" class="modal">
        <div class="modal-content">
            <h3>Reply to Inquiry</h3>
            <div class="form-row">
                <label for="replyToEmail">To</label>
                <input id="replyToEmail" type="email" readonly placeholder="recipient@example.com" />
            </div>
            <div class="form-row">
                <label for="replySubject">Subject</label>
                <input id="replySubject" type="text" placeholder="Subject" />
            </div>
            <div class="form-row">
                <label for="replyMessage">Message</label>
                <textarea id="replyMessage" rows="6" placeholder="Write your reply..."></textarea>
            </div>
            <div class="actions">
                <button onclick="closeReplyModal()" class="btn btn-cancel">Cancel</button>
                <button onclick="sendReplyEmail()" class="btn">Send Reply</button>
            </div>
        </div>
    </div>

    <!-- Add/Edit Service Modal -->
    <div id="serviceModal" class="modal">
        <div class="modal-content">
            <h3 id="serviceModalTitle">Add New Service</h3>
            <form id="serviceForm" onsubmit="saveService(event)">
                <div class="form-row">
                    <label for="serviceName">Service Name *</label>
                    <input id="serviceName" type="text" placeholder="e.g., Pedicure" required />
                </div>
                <div class="form-row">
                    <label for="serviceSlug">URL Slug *</label>
                    <input id="serviceSlug" type="text" placeholder="e.g., pedicure" required />
                    <small>Used in the URL (lowercase, no spaces)</small>
                </div>
                <div class="form-row">
                    <label for="serviceDescription">Short Description *</label>
                    <textarea id="serviceDescription" rows="2" placeholder="Brief description for service card"
                        required></textarea>
                </div>
                <div class="form-row">
                    <label for="serviceQuote">Quote/Tagline</label>
                    <input id="serviceQuote" type="text" placeholder="e.g., Relax and rejuvenate your feet" />
                </div>
                <div class="form-row">
                    <label for="serviceStatus">Status</label>
                    <select id="serviceStatus">
                        <option value="active">Active</option>
                        <option value="inactive">Inactive</option>
                    </select>
                </div>
                <div class="actions">
                    <button type="button" onclick="closeServiceModal()" class="btn btn-cancel">Cancel</button>
                    <button type="submit" class="btn">Save Service</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Manage Service Images Modal -->
    <div id="serviceImagesModal" class="modal">
        <div class="modal-content modal-wide">
            <h3 id="serviceImagesTitle">Manage Images</h3>
            <p id="serviceImagesSubtitle" class="modal-subtitle"></p>

            <div class="service-images-grid" id="serviceImagesGrid">
                <!-- Images will be loaded here -->
            </div>

            <div class="actions mt-20">
                <button onclick="closeServiceImagesModal()" class="btn btn-cancel">Close</button>
                <button onclick="openUploadForService()" class="btn">Upload New Images</button>
            </div>
        </div>
    </div>

    <!-- Add/Edit Testimonial Modal -->
    <div id="testimonialModal" class="modal">
        <div class="modal-content">
            <h3 id="testimonialModalTitle">Add New Testimonial</h3>
            <form id="testimonialForm" onsubmit="saveTestimonial(event)">
                <div class="form-row">
                    <label for="testimonialName">Customer Name *</label>
                    <input id="testimonialName" type="text" placeholder="e.g., Sarah Johnson" required />
                </div>
                <div class="form-row">
                    <label for="testimonialService">Service *</label>
                    <input id="testimonialService" type="text" placeholder="e.g., Gel Polish Client" required />
                </div>
                <div class="form-row">
                    <label for="testimonialRating">Rating *</label>
                    <select id="testimonialRating" required>
                        <option value="5">‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê (5 stars)</option>
                        <option value="4">‚≠ê‚≠ê‚≠ê‚≠ê (4 stars)</option>
                        <option value="3">‚≠ê‚≠ê‚≠ê (3 stars)</option>
                        <option value="2">‚≠ê‚≠ê (2 stars)</option>
                        <option value="1">‚≠ê (1 star)</option>
                    </select>
                </div>
                <div class="form-row">
                    <label for="testimonialText">Testimonial Text *</label>
                    <textarea id="testimonialText" rows="4" placeholder="What did the customer say about your service?"
                        required></textarea>
                </div>
                <div class="form-row">
                    <label for="testimonialStatus">Status</label>
                    <select id="testimonialStatus">
                        <option value="active">Active (Show on website)</option>
                        <option value="inactive">Inactive (Hidden)</option>
                    </select>
                </div>
                <div class="actions">
                    <button type="button" onclick="closeTestimonialModal()" class="btn btn-cancel">Cancel</button>
                    <button type="submit" class="btn">Save Testimonial</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Add/Edit Product Modal -->
    <div id="productModal" class="modal">
        <div class="modal-content">
            <h3 id="productModalTitle">Add New Product</h3>
            <form id="productForm" onsubmit="saveProduct(event)">
                <div class="form-row">
                    <label for="productName">Product Name *</label>
                    <input id="productName" type="text" placeholder="e.g., Press-On Nails Set" required />
                </div>
                <div class="form-row">
                    <label for="productPrice">Price (‚Ç¶) *</label>
                    <input id="productPrice" type="number" min="0" step="1" placeholder="e.g., 5000" required />
                </div>
                <div class="form-row">
                    <label for="productBadge">Badge/Label (optional)</label>
                    <input id="productBadge" type="text" placeholder="e.g., New, Best Seller, Sale" />
                    <small class="form-hint">Displayed as a small badge on the product (optional)</small>
                </div>
                <div class="form-row">
                    <label for="productDescription">Description</label>
                    <textarea id="productDescription" rows="3" placeholder="Short description"></textarea>
                </div>
                <div class="form-row">
                    <label for="productImage">Image</label>
                    <input id="productImage" type="file" accept="image/*" />
                    <small class="form-hint">Optional, JPG/PNG up to 2MB</small>
                </div>
                <div class="form-row">
                    <label for="productStatus">Status</label>
                    <select id="productStatus">
                        <option value="active">Active</option>
                        <option value="inactive">Inactive</option>
                    </select>
                </div>
                <div class="actions">
                    <button type="button" onclick="closeProductModal()" class="btn btn-cancel">Cancel</button>
                    <button type="submit" class="btn">Save Product</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Toast Notifications -->
    <div id="toastContainer" class="toast-container" aria-live="polite" aria-atomic="true"></div>

</body>

</html>